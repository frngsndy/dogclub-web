import{a as P,b as S,c as z,d as G}from"./chunk-KN23DME3.js";import{a as N}from"./chunk-AM5KUY4Y.js";import"./chunk-5LDVQD3R.js";import{b as L,d as W,g as F,o as j}from"./chunk-DSHYRTAC.js";import"./chunk-OOLK456B.js";import{Ac as k,Bc as Y,Gb as V,Hb as O,Ib as X,Ja as u,Mb as i,Nb as o,Ob as b,Pb as y,Qb as g,Rb as v,Ta as I,W as T,Wb as d,Yb as p,aa as f,f as w,g as D,ja as s,ka as c,ob as M,qb as R,rb as A,sb as e,tb as t,yb as B,zb as h}from"./chunk-RT37BCHY.js";var Q=(()=>{class l{constructor(){this.api=f(N)}getReport2(n){return this.api.post("/api/Report/report2",n)}static{this.\u0275fac=function(a){return new(a||l)}}static{this.\u0275prov=T({token:l,factory:l.\u0275fac,providedIn:"root"})}}return l})();var q=w(z()),_=w(G());var J=["excelTable"];function K(l,C){if(l&1&&(e(0,"tr",12)(1,"td",13),i(2),d(3,"date"),t(),e(4,"td",13),i(5),d(6,"date"),t(),e(7,"td",14),i(8),t(),e(9,"td",14),i(10),t(),e(11,"td",14),i(12),t(),e(13,"td",14),i(14),t(),e(15,"td",14),i(16),t(),e(17,"td",14),i(18),t(),e(19,"td",14),i(20),t(),e(21,"td",14),i(22),t(),e(23,"td",14),i(24),t(),e(25,"td",14),i(26),t()()),l&2){let n=C.$implicit;u(2),o(p(3,12,n.date,"EEE")),u(3),o(p(6,15,n.date,"dd/MM/yyyy")),u(3),o(n.numOfCustomer),u(2),o(n.numTime1),u(2),o(n.numTime2),u(2),o(n.numTime3),u(2),o(n.numTime4),u(2),o(n.numTime5),u(2),o(n.numTime6),u(2),o(n.numOfReceipt),u(2),o(n.treatment),u(2),o(n.numOfReceipt-n.treatment)}}function U(l,C){l&1&&(e(0,"tr")(1,"td",15),i(2,"No data."),t()())}var Ee=(()=>{class l{constructor(){this._report2Api=f(Q),this.startDate=(0,_.default)().format("YYYY-MM-DD"),this.endDate=(0,_.default)().format("YYYY-MM-DD"),this.items=[]}ngOnInit(){this.fetchData()}fetchData(){return D(this,null,function*(){let n={startDate:this.startDate,endDate:this.endDate},a=yield this._report2Api.getReport2(n);a.data&&(this.items=a.data)})}onChange(n){this.fetchData()}totalCase(){return this.items.reduce((a,r)=>a+r.numOfCustomer,0)??0}maximumCase(){let n=this.items.reduce((a,r)=>r.numOfCustomer>a.numOfCustomer?r:a,this.items[0]);return n==null?0:n.numOfCustomer}minimumCase(){let n=this.items.reduce((a,r)=>r.numOfCustomer<a.numOfCustomer?r:a,this.items[0]);return n==null?0:n.numOfCustomer}exportToExcel(){let n=S.table_to_sheet(this.excelTable.nativeElement),a=S.book_new();S.book_append_sheet(a,n,"Sheet1");let r=P(a,{bookType:"xlsx",type:"array"}),E=new Blob([r],{type:"application/octet-stream"});(0,q.saveAs)(E,"TableExport.xlsx")}static{this.\u0275fac=function(a){return new(a||l)}}static{this.\u0275cmp=I({type:l,selectors:[["app-report2"]],viewQuery:function(a,r){if(a&1&&V(J,5),a&2){let E;O(E=X())&&(r.excelTable=E.first)}},decls:68,vars:23,consts:[["excelTable",""],[1,"flex","flex-col","px-6","py-4","bg-white","rounded-2xl"],[1,"p-2","text-2xl","font-semibold"],[1,"flex","flex-col","sm:flex-row","gap-4","pb-2"],[1,"flex","flex-row","gap-2"],[1,"font-semibold"],["type","date",3,"ngModelChange","change","ngModel"],[1,"bg-primary","hover:bg-primary/90","text-foreground","hover:text-foreground/90","cursor-pointer","flex-none","rounded-md","px-4","py-2.5","text-xs","font-semibold",3,"click"],[1,"border","border-gray-300","rounded-lg","overflow-auto"],[1,"w-full","border-collapse"],[1,"border-b","bg-gray-100"],[1,"px-2"],[1,"hover:bg-gray-50"],[1,"px-2","border-b","text-xs"],[1,"px-2","border-b","text-xs","text-right"],["colspan","12",1,"p-2","text-center","text-sm"]],template:function(a,r){if(a&1){let E=B();e(0,"div",1)(1,"div",2),i(2,"\u0E23\u0E32\u0E22\u0E07\u0E32\u0E19\u0E08\u0E33\u0E19\u0E27\u0E19\u0E2A\u0E31\u0E15\u0E27\u0E4C\u0E23\u0E32\u0E22\u0E41\u0E1E\u0E17\u0E22\u0E4C"),t(),e(3,"div",3)(4,"div",4)(5,"label",5),i(6),d(7,"date"),t(),e(8,"input",6),v("ngModelChange",function(m){return s(E),g(r.startDate,m)||(r.startDate=m),c(m)}),h("change",function(m){return s(E),c(r.onChange(m))}),t()(),e(9,"div",4)(10,"label",5),i(11),d(12,"date"),t(),e(13,"input",6),v("ngModelChange",function(m){return s(E),g(r.endDate,m)||(r.endDate=m),c(m)}),h("change",function(m){return s(E),c(r.onChange(m))}),t()(),e(14,"button",7),h("click",function(){return s(E),c(r.exportToExcel())}),i(15," Export Excel "),t()(),e(16,"div",3)(17,"div",4)(18,"label",5),i(19,"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E04\u0E2A\u0E17\u0E31\u0E49\u0E07\u0E2B\u0E21\u0E14 : "),t(),e(20,"label"),i(21),d(22,"number"),t()(),e(23,"div",4)(24,"label",5),i(25,"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E04\u0E2A\u0E15\u0E48\u0E33\u0E2A\u0E38\u0E14 : "),t(),e(26,"label"),i(27),d(28,"number"),t()(),e(29,"div",4)(30,"label",5),i(31,"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E04\u0E2A\u0E2A\u0E39\u0E07\u0E2A\u0E38\u0E14 : "),t(),e(32,"label"),i(33),d(34,"number"),t()()(),e(35,"div",8)(36,"table",9,0)(38,"thead")(39,"tr",10)(40,"th",11),i(41,"\u0E27\u0E31\u0E19"),t(),e(42,"th",11),i(43,"\u0E27\u0E31\u0E19/\u0E40\u0E14\u0E37\u0E2D\u0E19/\u0E1B\u0E35"),t(),e(44,"th",11),i(45,"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E25\u0E39\u0E01\u0E04\u0E49\u0E32"),t(),e(46,"th",11),i(47,"\u0E19\u0E49\u0E2D\u0E22\u0E01\u0E27\u0E48\u0E32 9.30"),t(),e(48,"th",11),i(49,"9.30 - 12.00"),t(),e(50,"th",11),i(51,"12.01 - 15.00"),t(),e(52,"th",11),i(53,"15.01 - 18.00"),t(),e(54,"th",11),i(55,"18.01 - 20.30"),t(),e(56,"th",11),i(57,"\u0E21\u0E32\u0E01\u0E01\u0E27\u0E48\u0E32 20.30"),t(),e(58,"th",11),i(59,"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E43\u0E1A\u0E40\u0E2A\u0E23\u0E47\u0E08"),t(),e(60,"th",11),i(61,"Treatment"),t(),e(62,"th",11),i(63,"NonTreatment"),t()()(),e(64,"tbody"),R(65,K,27,18,"tr",12,M,!1,U,3,0,"tr"),t()()()()}a&2&&(u(6),b("\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E40\u0E23\u0E34\u0E48\u0E21 ",p(7,8,r.startDate,"dd/MM/yyyy"),""),u(2),y("ngModel",r.startDate),u(3),b("\u0E16\u0E36\u0E07\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48 ",p(12,11,r.endDate,"dd/MM/yyyy"),""),u(2),y("ngModel",r.endDate),u(8),o(p(22,14,r.totalCase(),"0.0")),u(6),o(p(28,17,r.minimumCase(),"0.0")),u(6),o(p(34,20,r.maximumCase(),"0.0")),u(32),A(r.items))},dependencies:[k,j,L,W,F,Y],encapsulation:2})}}return l})();export{Ee as Report2Component};
