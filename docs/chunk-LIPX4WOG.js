import{a as N,b as x,c as G,d as H}from"./chunk-KN23DME3.js";import{a as Q}from"./chunk-AM5KUY4Y.js";import"./chunk-5LDVQD3R.js";import{b as A,d as F,g as j,o as P}from"./chunk-DSHYRTAC.js";import"./chunk-OOLK456B.js";import{Ac as L,Bc as W,Gb as X,Hb as k,Ib as Y,Ja as d,Mb as a,Nb as E,Ob as b,Pb as y,Qb as _,Rb as w,Ta as M,W as C,Wb as m,Yb as c,aa as h,f as D,g as S,ja as s,ka as u,ob as T,qb as R,rb as V,sb as n,tb as r,ub as I,yb as B,zb as g}from"./chunk-RT37BCHY.js";var q=(()=>{class o{constructor(){this.api=h(Q)}getReport3(i){return this.api.post("/api/Report/report3",i)}static{this.\u0275fac=function(e){return new(e||o)}}static{this.\u0275prov=C({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var O=D(G()),v=D(H());var K=["excelTable"];function U(o,z){if(o&1&&(n(0,"tr")(1,"td",13),a(2),r(),n(3,"td",14),a(4),m(5,"number"),r(),n(6,"td",15),a(7),m(8,"number"),r()()),o&2){let i=z.$implicit;d(2),E(i.name),d(2),E(c(5,3,i.total,"0.0")),d(3),E(c(8,6,i.count,"0.0"))}}var se=(()=>{class o{constructor(){this._report3Api=h(q),this.startDate=(0,v.default)().format("YYYY-MM-DD"),this.endDate=(0,v.default)().format("YYYY-MM-DD"),this.items=[]}ngOnInit(){this.fetchData()}fetchData(){return S(this,null,function*(){let i={startDate:this.startDate,endDate:this.endDate},e=yield this._report3Api.getReport3(i);e.data&&(this.items=e.data)})}onChange(i){this.fetchData()}total(){return this.items.reduce((i,e)=>i+e.total,0)}exportToExcel(){let i=x.table_to_sheet(this.excelTable.nativeElement),e=x.book_new();x.book_append_sheet(e,i,"Sheet1");let t=N(e,{bookType:"xlsx",type:"array"}),p=new Blob([t],{type:"application/octet-stream"});(0,O.saveAs)(p,"TableExport.xlsx")}static{this.\u0275fac=function(e){return new(e||o)}}static{this.\u0275cmp=M({type:o,selectors:[["app-report3"]],viewQuery:function(e,t){if(e&1&&X(K,5),e&2){let p;k(p=Y())&&(t.excelTable=p.first)}},decls:37,vars:14,consts:[["excelTable",""],[1,"flex","flex-col","px-6","py-4","bg-white","rounded-2xl"],[1,"p-2","text-2xl","font-semibold"],[1,"flex","flex-col","sm:flex-row","gap-4","pb-2"],[1,"flex","flex-row","gap-2"],[1,"font-semibold"],["type","date",3,"ngModelChange","change","ngModel"],[1,"bg-primary","hover:bg-primary/90","text-foreground","hover:text-foreground/90","cursor-pointer","flex-none","rounded-md","px-4","py-2.5","text-xs","font-semibold",3,"click"],[1,"border","border-gray-300","rounded-lg","overflow-auto"],[1,"w-full","border-collapse"],[1,"border-b","bg-gray-100"],[1,"p-2"],[1,"p-2","text-right"],[1,"p-2","border-b","border-r"],[1,"p-2","border-b","border-r","text-right"],[1,"p-2","border-b","text-right"]],template:function(e,t){if(e&1){let p=B();n(0,"div",1)(1,"div",2),a(2,"\u0E23\u0E32\u0E22\u0E07\u0E32\u0E19 Forecast"),r(),n(3,"div",3)(4,"div",4)(5,"label",5),a(6),m(7,"date"),r(),n(8,"input",6),w("ngModelChange",function(l){return s(p),_(t.startDate,l)||(t.startDate=l),u(l)}),g("change",function(l){return s(p),u(t.onChange(l))}),r()(),n(9,"div",4)(10,"label",5),a(11),m(12,"date"),r(),n(13,"input",6),w("ngModelChange",function(l){return s(p),_(t.endDate,l)||(t.endDate=l),u(l)}),g("change",function(l){return s(p),u(t.onChange(l))}),r()(),n(14,"button",7),g("click",function(){return s(p),u(t.exportToExcel())}),a(15," Export Excel "),r()(),n(16,"div",8)(17,"table",9,0)(19,"thead")(20,"tr",10)(21,"th",11),a(22,"\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23"),r(),n(23,"th",11),a(24,"\u0E22\u0E2D\u0E14\u0E23\u0E27\u0E21"),r(),n(25,"th",11),a(26,"\u0E15\u0E31\u0E27"),r()()(),n(27,"tbody"),R(28,U,9,9,"tr",null,T),n(30,"tr")(31,"td",11),a(32,"\u0E23\u0E27\u0E21"),r(),n(33,"td",12),a(34),m(35,"number"),r(),I(36,"td",12),r()()()()()}e&2&&(d(6),b("\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E40\u0E23\u0E34\u0E48\u0E21 ",c(7,5,t.startDate,"dd/MM/yyyy"),""),d(2),y("ngModel",t.startDate),d(3),b("\u0E16\u0E36\u0E07\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48 ",c(12,8,t.endDate,"dd/MM/yyyy"),""),d(2),y("ngModel",t.endDate),d(15),V(t.items),d(6),E(c(35,11,t.total(),"0.0")))},dependencies:[L,P,A,F,j,W],encapsulation:2})}}return o})();export{se as Report3Component};
